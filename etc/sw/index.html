<!DOCTYPE html>
<html lang="en-us">
<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <title>Ed Herbst/etc/sw/</title>
    
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="robots" content="all,follow">
    <meta name="googlebot" content="index,follow,snippet,archive">
    <link rel="stylesheet" href="https://edherbst.net/hugo-theme-console/css/terminal-0.7.1.min.css">
    <link rel="stylesheet" href="https://edherbst.net/hugo-theme-console/css/animate-3.7.2.min.css">
    <link rel="stylesheet" href="https://edherbst.net/hugo-theme-console/css/console.css">
    
      <!--[if lt IE 9]>
          <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
          <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
      <![endif]-->
       <meta property="og:title" content="Stock and Watson (2007) in pymc3 and Stan" />
<meta property="og:description" content="" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://edherbst.net/etc/sw/" /><meta property="article:published_time" content="2017-09-10T00:00:00-04:00" />



<meta name="twitter:title" content="Stock and Watson (2007) in pymc3 and Stan"/>
<meta name="twitter:description" content="This file is available as Jupyter Notebook.
The STOCK_2007 model inflation as an unobserved components models:
\begin{eqnarray} \pi_t &amp;=&amp; \tau_t &#43; \eta_t \\\
\tau_t &amp;=&amp; \tau_{t-1} &#43; \epsilon_t \end{eqnarray}
where \(\eta_t\) and \(\epsilon_t\) are independently and identically distributed with mean 0 and variances \(\sigma_\eta^2\) and \(\sigma_\epsilon^2\).
A Replication First we start by importing some standard libraries.
%matplotlib inline import matplotlib.pyplot as plt import numpy as np import pandas as p Next we get the data used and plot it."/>

</head>
<body class="terminal">
    <div class="container">
        <div class="terminal-nav">
          <header class="terminal-logo">
            <div class="logo terminal-prompt">
              
              
              
              <a href='https://edherbst.net/etc'>etc</a>/<a href='https://edherbst.net/etc/sw'>sw</a>/</div></header>
          <nav class="terminal-menu">
            <ul vocab="https://schema.org/" typeof="BreadcrumbList">
                
                <li><a href="https://edherbst.net/" typeof="ListItem">&lt;/&gt;</a></li>
                
                <li><a href="https://edherbst.net/research/" typeof="ListItem">research</a></li>
                
                <li><a href="https://edherbst.net/teaching/" typeof="ListItem">teaching</a></li>
                
                <li><a href="https://edherbst.net/etc/" typeof="ListItem">et cetera</a></li>
                
            </ul>
          </nav>
        </div>
    </div>

    <div class="container animated zoomIn fast">
        
<h1>Stock and Watson (2007) in pymc3 and Stan</h1>
<p><em>This file is available as Jupyter Notebook</em>.</p>
<p>The <sup id="751475a24881d3cf8ff77e5dc432fc83"><a href="#STOCK_2007" title="Stock \&amp; Watson, Why Has U.S. Inflation Become Harder to Forecast?, {Journal of Money, Credit and Banking}, v(), 3 33 (2007).">STOCK_2007</a></sup> model inflation as an unobserved components
models:</p>
<p>\begin{eqnarray}
\pi_t &amp;=&amp; \tau_t + \eta_t \\\<br>
\tau_t &amp;=&amp; \tau_{t-1} + \epsilon_t
\end{eqnarray}</p>
<p>where \(\eta_t\) and \(\epsilon_t\) are independently and identically
distributed with mean 0 and variances \(\sigma_\eta^2\) and
\(\sigma_\epsilon^2\).</p>
<h2 id="a-replication">A Replication</h2>
<p>First we start by importing some standard libraries.</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-fallback" data-lang="fallback">%matplotlib inline
import matplotlib.pyplot as plt
import numpy as np
import pandas as p
</code></pre></div><p>Next we get the data used and plot it.</p>
<figure>
    <img src="https://edherbst.net/ox-hugo/0877b3a1f8ff225d7686ac63f7450e3a7e6c5a87.png"
         alt="Figure 1: Inflation Data"/> <figcaption>
            <p>Figure 1: Inflation Data</p>
        </figcaption>
</figure>

<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-fallback" data-lang="fallback">from pymc3 import Model, Normal, InverseGamma, sample
from pymc3.distributions.timeseries import GaussianRandomWalk

from pymc3 import Uniform, Deterministic
from pymc3.math import exp, sqrt

y = sw_infl[&#39;1953&#39;:&#39;2004&#39;].values.flatten()

with Model() as ucsv_model:

    gamma = 0.2
    ln_sigma2_eps = GaussianRandomWalk(&#39;ln_sigma2_eps&#39;, sd=gamma, shape=len(y)-1)
    ln_sigma2_eta = GaussianRandomWalk(&#39;ln_sigma2_eta&#39;, sd=gamma, shape=len(y))

    sigma_eps = Deterministic(&#39;sigma_eps&#39;, exp(0.5*ln_sigma2_eps))
    tau = GaussianRandomWalk(&#39;tau&#39;, sd=sigma_eps, shape=len(y))

    sigma_eta = Deterministic(&#39;sigma_eta&#39;, exp(0.5*ln_sigma2_eta))
    pinf = Normal(&#39;pi&#39;,mu=tau, sd=sigma_eta, observed=y)

    temp = Deterministic(&#39;temp&#39;, sigma_eta[1:]**2/(sigma_eps**2 + 2*sigma_eta[1:]**2))
    theta = Deterministic(&#39;theta&#39;, (-1 + sqrt(1-4*temp*temp)) /(-2*temp))
</code></pre></div><div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-fallback" data-lang="fallback">with ucsv_model:
    trace = sample(2000)

sigma_eps_df = p.DataFrame(trace[&#39;sigma_eps&#39;],columns=sw_infl[&#39;1953Q2&#39;:&#39;2004&#39;].index)
sigma_eta_df = p.DataFrame(trace[&#39;sigma_eta&#39;],columns=sw_infl[&#39;1953&#39;:&#39;2004&#39;].index)
theta_df = p.DataFrame(trace[&#39;theta&#39;],columns=sw_infl[&#39;1953Q2&#39;:&#39;2004&#39;].index)
</code></pre></div><div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-fallback" data-lang="fallback">def sw_figure2(sigma_eps, sigma_eta, theta):
    fig,ax = plt.subplots(nrows=3, sharex=True)

    for i, para in enumerate([sigma_eps, sigma_eta, theta]):

        if i &lt; 2:
            ylim = (0,2)
        else:
            ylim = (0,1)

        para.median().plot(ax=ax[i], color=&#39;black&#39;, ylim=ylim)
        para.quantile([0.16,0.84]).T.plot(ax=ax[i], color=&#39;black&#39;,
                                          linestyle=&#39;dashed&#39;, legend=False)

    plt.tight_layout()
    fig.set_size_inches(3,9)

sw_figure2(sigma_eps_df, sigma_eta_df, theta_df)
</code></pre></div><div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-text" data-lang="text">
NameErrorTraceback (most recent call last)
&lt;ipython-input-8-16860f4ca04e&gt; in &lt;module&gt;
     16     fig.set_size_inches(3,9)
     17
---&gt; 18 sw_figure2(sigma_eps_df, sigma_eta_df, theta_df)

NameError: name &#39;sigma_eps_df&#39; is not defined
</code></pre></div><h1 id="bibliography">Bibliography</h1>
<p><a id="STOCK_2007"></a>[STOCK_2007] Stock &amp; Watson, Why Has U.S. Inflation Become Harder to Forecast?, <i>Journal of Money, Credit and Banking</i>, <b>39</b>, 3 33 (2007). <a href="http://dx.doi.org/10.1111/j.1538-4616.2007.00014.x">link</a>. <a href="http://dx.doi.org/10.1111/j.1538-4616.2007.00014.x">doi</a>. <a href="#751475a24881d3cf8ff77e5dc432fc83">â†©</a></p>



<script type="text/x-mathjax-config">
MathJax.Hub.Config({
  TeX: { equationNumbers: { autoNumber: "AMS" },
         extensions: ["AMSmath.js", "AMSsymbols.js"] },
  tex2jax: {
      inlineMath: [['$','$'],['\\(','\\)']],
      displayMath: [['$$','$$'], ['\\[', '\\]']],
    processEscapes: true,
    processEnvironments: true,
    skipTags: ['script', 'noscript', 'style', 'textarea', 'pre']
  }
});
</script>
<script type="text/javascript"
  src="//cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
</script>


        <div class="footer">
    Powered by <a href="https://gohugo.io/">Hugo</a> with
    <a href="https://github.com/mrmierzejewski/hugo-theme-console/">Console Theme</a>. 
</div>

    </div>
  </body>
</html>
